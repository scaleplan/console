#!/usr/bin/env php
<?php

require_once $_SERVER['DOCUMENT_ROOT'] . '/vendor/autoload.php';

use Scaleplan\Console\CommandFabric;
use Scaleplan\Console\Exceptions\CommandNameIsEmptyException;

$dotEnv = Dotenv\Dotenv::create(__DIR__);
$dotEnv->load();

try {
    if (!($commandName = $argv[1] ?? null)) {
        throw new CommandNameIsEmptyException();
    }

    unset($argv[0], $argv[1]);

    $command = CommandFabric::getCommand($commandName, array_values($argv));
    $command->run();
} catch (\Scaleplan\Console\Exceptions\CommandException $e) {
    echo $e->getMessage();
}
